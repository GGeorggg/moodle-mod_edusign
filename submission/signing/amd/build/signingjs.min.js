function initialize(){function a(a,b){var c=a.getBoundingClientRect();return{x:(h?b.touches[0].clientX:b.clientX)-c.left,y:(h?b.touches[0].clientY:b.clientY)-c.top}}function b(){e&&(ctx.moveTo(g.x,g.y),ctx.lineTo(f.x,f.y),ctx.stroke(),g.x==f.x&&g.y==f.y&&(ctx.moveTo(g.x,g.y),ctx.arc(g.x,g.y,.5,0,2*Math.PI,!1)),g=f)}function c(a,b){b.clearRect(0,0,a.width,a.height),a.width=a.width}canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d");var d=canvas.getBoundingClientRect();canvas.width=d.width,canvas.height=d.height,ctx.strokeStyle="#000",ctx.lineWidth=1,c(canvas,ctx);var e=!1,f={x:0,y:0},g=f,h="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch;$("#clearCanvas").bind("click",function(){c(canvas,ctx)}),$("#id_submitbutton").click(function(){var a=$("#canvas")[0].toDataURL();$('[name="signing"]').val(a)}),canvas.addEventListener(h?"touchstart":"mousedown",function(b){b.preventDefault(),b.stopPropagation(),e=!0,g=a(canvas,b),f=g}),canvas.addEventListener(h?"touchmove":"mousemove",function(b){b.preventDefault(),b.stopPropagation(),f=a(canvas,b)}),canvas.addEventListener(h?"touchend":"mouseup",function(a){a.preventDefault(),a.stopPropagation(),e=!1}),document.body.addEventListener("touchstart",function(a){a.target==canvas&&(a.preventDefault(),a.stopPropagation())},!1),document.body.addEventListener("touchend",function(a){a.target==canvas&&(a.preventDefault(),a.stopPropagation())},!1),document.body.addEventListener("touchmove",function(a){a.target==canvas&&(a.preventDefault(),a.stopPropagation())},!1),window.requestAnimFrame=function(a){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}(),function i(){requestAnimFrame(i),b()}(),$(window).resize(function(){var a=canvas.width,b=canvas.height,c=ctx.getImageData(0,0,a,b),d=canvas.getBoundingClientRect();canvas.width=d.width,canvas.height=d.height,a=canvas.width,b=canvas.height,ctx.putImageData(c,0,0)})}define(["jquery"],function(a){return{init:function(){initialize()},save:function(){initialize()}}});